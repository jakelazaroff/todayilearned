---
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const entries = await getCollection("til");
  return entries.map(entry => {
    const [category, slug] = entry.slug.split("/");
    return {
      params: { category, slug },
      props: entry
    };
  });
}

import HTML from "../../layout/HTML.astro";
import Layout from "../../layout/Layout.astro";
import { getInfo } from "../../util/entry";

const info = await getInfo(Astro.props);
const { Content } = await Astro.props.render();
---

<HTML title={`[${info.category}] ${info.title}`}>
  <Layout slug={Astro.props.slug}>
    <article class="content">
      <Content />
    </article>
  </Layout>
</HTML>

<style>
  .content {
    max-width: max(960px, 80ch);
    overflow-x: hidden;

    @media (min-width: 960px) {
      overflow: visible;
    }
  }

  .content > :global(:first-child:not([class])) {
    margin: 0;
  }

  .content :global(.astro-code) {
    padding: 16px;
    border-radius: 4px;
    font-size: round(0.95em, 1px);
    line-height: 1.75;
    word-wrap: normal;
    overflow: auto;
    max-width: 100%;
  }

  .content :global(.astro-code) :global(code) {
    font-weight: normal;
  }

  .content :global(img) {
    border-radius: 4px;
    overflow: hidden;
    box-shadow: 0 0 0 1px #00000022;
    margin-inline: auto;
    width: auto;
  }
</style>
